Seed set to 42
Using device: cpu
CPU cores available: 32
CPU cores using: 24
Data root directory: /home/krschap/rabina/data/s2a_subset
========================
Dataset config: DataConfig(data_root_dir='/home/krschap/rabina/data/s2a_subset', compute_stats=True, n_samples=None, batch_size=128, patch_size=264, num_workers=24)
========================
Training config: TrainingConfig(experiment_out_dir='output/ssl_subset_v2_e50_b256_mem_8k', model='resnet50', in_channels=13, version=2, lr=0.0002, use_peft=False, temperature=0.15, memory_bank_size=8192, target_size=224, max_epochs=100, batch_size=128, ckpt_path=None, weight_decay=0.0001, moco_momentum=0.995)
Total samples in dataset: 32567
Calculating stats on the entire dataset...
Total batches to process: 255
Processed batch 20/255 
Processed batch 40/255 
Processed batch 60/255 
Processed batch 80/255 
Processed batch 100/255 
Processed batch 120/255 
Processed batch 140/255 
Processed batch 160/255 
Processed batch 180/255 
Processed batch 200/255 
Processed batch 220/255 
Processed batch 240/255 
Processed batch 255/255 
calculate_stats time: 0.58 min
Mean: tensor([1353.9951, 1509.2384, 1764.3514, 2005.2811, 2338.1492, 2837.3188,
        3057.8025, 3186.8677, 3214.5554, 3324.5664,    0.0000, 2632.6152,
        2074.0703])
Std: tensor([2251.5820, 2250.2544, 2132.0840, 2187.5188, 2156.2498, 1969.8088,
        1909.7422, 1970.6365, 1823.0107, 2047.6980,    0.0001, 1256.4541,
        1126.3496])
32567
torch.Size([13, 224, 224])
Number of batches: 255
/home/krschap/rabina/ICPR-Contest-2026/.venv/lib/python3.13/site-packages/torchgeo/trainers/moco.py:209: UserWarning: MoCo v2 only uses 2 layers in its projection head
  warnings.warn('MoCo v2 only uses 2 layers in its projection head')
Full fine-tuning: backbone and projection head trainable...
+--------------------------+------------------------+------------------+--------------+
|          Module          |          Type          | Trainable Params | Total Params |
+--------------------------+------------------------+------------------+--------------+
|         backbone         |         ResNet         |    23,539,392    |  23,539,392  |
|    backbone_momentum     |         ResNet         |        0         |  23,539,392  |
|     projection_head      |   MoCoProjectionHead   |    26,222,848    |  26,222,848  |
| projection_head_momentum |   MoCoProjectionHead   |        0         |  26,222,848  |
|        criterion         |       NTXentLoss       |        0         |      0       |
|      augmentation1       | AugmentationSequential |        0         |      0       |
+--------------------------+------------------------+------------------+--------------+
Total trainable parameters: 49,762,240 (49.76 M)
Total parameters: 99,524,480 (99.52 M)
/home/krschap/rabina/ICPR-Contest-2026/.venv/lib/python3.13/site-packages/lightning/fabric/connector.py:571: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
ğŸ’¡ Tip: For seamless cloud logging and experiment tracking, try installing [litlogger](https://pypi.org/project/litlogger/) to enable LitLogger, which logs metrics and artifacts automatically to the Lightning Experiments platform.
USING DEVICE CONFIRMATION cpu
/home/krschap/rabina/ICPR-Contest-2026/.venv/lib/python3.13/site-packages/lightning/pytorch/trainer/configuration_validator.py:70: You defined a `validation_step` but have no `val_dataloader`. Skipping val loop.
You are using a CUDA device ('NVIDIA GeForce RTX 4090 Laptop GPU') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/krschap/rabina/ICPR-Contest-2026/.venv/lib/python3.13/site-packages/lightning/pytorch/utilities/model_summary/model_summary.py:242: Precision 16-mixed is not supported by the model summary.  Estimated model size in MB will not be accurate. Using 32 bits instead.
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                     â”ƒ Type                   â”ƒ Params â”ƒ Mode  â”ƒ FLOPs â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ backbone                 â”‚ ResNet                 â”‚ 23.5 M â”‚ train â”‚     0 â”‚
â”‚ 1 â”‚ backbone_momentum        â”‚ ResNet                 â”‚ 23.5 M â”‚ train â”‚     0 â”‚
â”‚ 2 â”‚ projection_head          â”‚ MoCoProjectionHead     â”‚ 26.2 M â”‚ train â”‚     0 â”‚
â”‚ 3 â”‚ projection_head_momentum â”‚ MoCoProjectionHead     â”‚ 26.2 M â”‚ train â”‚     0 â”‚
â”‚ 4 â”‚ criterion                â”‚ NTXentLoss             â”‚      0 â”‚ train â”‚     0 â”‚
â”‚ 5 â”‚ augmentation1            â”‚ AugmentationSequential â”‚      0 â”‚ train â”‚     0 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 49.8 M                                                                                                                                                                                                                          
Non-trainable params: 49.8 M                                                                                                                                                                                                                      
Total params: 99.5 M                                                                                                                                                                                                                              
Total estimated model params size (MB): 398                                                                                                                                                                                                       
Modules in train mode: 460                                                                                                                                                                                                                        
Modules in eval mode: 0                                                                                                                                                                                                                           
Total FLOPs: 0                                                                                                                                                                                                                                    
/home/krschap/rabina/ICPR-Contest-2026/.venv/lib/python3.13/site-packages/lightning/pytorch/utilities/_pytree.py:21: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
Epoch 99/99 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 255/255 0:01:52 â€¢ 0:00:00 2.40it/s v_num: 0.000`Trainer.fit` stopped: `max_epochs=100` reached.
Epoch 99/99 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 255/255 0:01:52 â€¢ 0:00:00 2.40it/s v_num: 0.000
After fit device: cpu
Training time: 187.66767741839092 min
`weights_only` was not set, defaulting to `False`.